# Contributing Guide

## Разработка

### Установка для разработки

```bash
# Клонируйте репозиторий
git clone <repo-url>
cd ssh-switch-script

# Установите зависимости
npm install

# Создайте симлинк для локального тестирования
npm link
```

После `npm link` команда `sshswitch` будет запускать локальную версию скрипта, что удобно для разработки.

### Структура проекта

```
ssh-switch-script/
├── index.js              # Основной скрипт
├── package.json          # Конфигурация npm
├── README.md            # Основная документация
├── QUICKSTART.md        # Краткий гайд
├── CONTRIBUTING.md      # Это файл
└── node_modules/        # Зависимости (в .gitignore)
```

### Основные функции

#### `getCurrentProfile()`
Читает файл `~/.ssh/.current_profile` и возвращает имя текущего профиля.

#### `setCurrentProfile(profileName)`
Сохраняет имя текущего профиля в `~/.ssh/.current_profile`.

#### `getAvailableProfiles()`
Сканирует `~/.ssh/` и возвращает список папок, содержащих `id_rsa` файлы.

#### `switchProfile(profileName)`
Копирует SSH ключи из папки профиля в корень `~/.ssh/` и обновляет права доступа.

#### `createNewProfile()`
Создает новую папку профиля и генерирует SSH ключи через `ssh-keygen`.

#### `displayHeader()`
Отображает заголовок CLI приложения.

#### `main()`
Главная функция, которая управляет всем flow приложения.

### Зависимости

- **inquirer** (^8.2.5) - Создание интерактивных CLI меню
- **chalk** (^4.1.2) - Цветной вывод в терминал

Версии специально зафиксированы на 4.x для chalk и 8.x для inquirer для совместимости с CommonJS.

### Тестирование

```bash
# Запуск локально
npm start

# Запуск через симлинк
sshswitch

# Проверка что профили обнаруживаются
ls -la ~/.ssh/
```

### Добавление новых функций

1. Создайте новую функцию в `index.js`
2. Добавьте её вызов в соответствующем месте
3. Протестируйте локально с `npm start`
4. Обновите README.md если добавлена новая функциональность

### Стиль кода

- Используем CommonJS модули (`require`/`module.exports`)
- Async/await для асинхронных операций
- Chalk для цветного вывода
- Inquirer для интерактивности
- Читаемые имена переменных и функций
- Комментарии для сложной логики

### Обработка ошибок

Все критичные операции обернуты в try-catch блоки:
- Чтение/запись файлов
- Копирование SSH ключей
- Вызов внешних команд

### Права доступа

Скрипт автоматически устанавливает правильные права:
- `600` (rw-------) для приватных ключей
- `644` (rw-r--r--) для публичных ключей

### Публикация

```bash
# Обновите версию в package.json
npm version patch  # или minor/major

# Опубликуйте (если настроен npm registry)
npm publish
```

## Идеи для улучшений

- [ ] Добавить поддержку ed25519 ключей
- [ ] Добавить backup функцию перед переключением
- [ ] Поддержка конфигурационного файла (~/.sshswitchrc)
- [ ] Интеграция с git config для автоматической смены user.name/user.email
- [ ] История переключений профилей
- [ ] Тесты (Jest)
- [ ] CI/CD pipeline

## Баги и предложения

Создавайте issue в GitHub репозитории с подробным описанием проблемы или предложения.

